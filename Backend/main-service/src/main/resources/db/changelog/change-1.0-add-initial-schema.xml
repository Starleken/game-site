<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                                       http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

    <changeSet id="1.0.0" author="Starleken">
        <sql>
            create table genres
            (
                id   bigint generated by default as identity
                    primary key,
                name varchar(255)
            );
        </sql>

        <sql>
            create table images
            (
                id          uuid not null primary key,
                image_url   varchar(255) not null,
                source_name varchar(255) not null
            );
        </sql>

        <sql>
            create table users
            (
                created_at timestamp(6) not null,
                created_by bigint,
                id         bigint generated by default as identity
                    primary key,
                updated_at timestamp(6),
                updated_by bigint,
                email      varchar(255) not null,
                password   varchar(255) not null,
                role       varchar(255) not null
                    constraint users_role_check
                        check ((role)::text = ANY ((ARRAY ['ADMIN'::character varying, 'USER'::character varying])::text[])),
                username   varchar(255) not null
            );
        </sql>

        <sql>
            create table games
            (
                created_at   timestamp(6) not null,
                created_by   bigint,
                header_image uuid
                    unique
                    constraint fkcxcw9kl6r7hdcn7d9eg4nt19r
                        references images,
                id           bigint generated by default as identity
                    primary key,
                updated_at   timestamp(6),
                updated_by   bigint,
                description  varchar(255) not null,
                name         varchar(255) not null
            );
        </sql>

        <sql>
            create table posts
            (
                created_at timestamp(6) not null,
                created_by bigint,
                id         bigint generated by default as identity
                    primary key,
                image_id   uuid
                    unique
                    constraint fkdt44ngxibfjiwb1w59qd23xmw
                        references images,
                updated_at timestamp(6),
                updated_by bigint,
                content    varchar(255) not null,
                header     varchar(255) not null
            );
        </sql>

        <sql>
            create table comments
            (
                created_at timestamp(6) not null,
                created_by bigint,
                id         bigint generated by default as identity
                    primary key,
                post_id    bigint       not null
                    constraint fkh4c7lvsc298whoyd4w9ta25cr
                        references posts,
                updated_at timestamp(6),
                updated_by bigint,
                content    varchar(255) not null
            );
        </sql>

        <sql>
            create table reviews
            (
                grade      integer      not null,
                created_at timestamp(6) not null,
                created_by bigint,
                game_id    bigint       not null
                    constraint fk1cmcqkmc8g630wpn52m1mv8re
                        references games,
                id         bigint generated by default as identity
                    primary key,
                updated_at timestamp(6),
                updated_by bigint,
                content    varchar(255) not null
            );
        </sql>

        <sql>
            create table games_images
            (
                game_id  bigint not null
                    constraint fk1aiw61fmb5xcywwmx5xd75anp
                        references games,
                image_id uuid not null
                    constraint fkbtnr9lwwwhab7objburqbdfhh
                        references images
            );
        </sql>
    </changeSet>

</databaseChangeLog>